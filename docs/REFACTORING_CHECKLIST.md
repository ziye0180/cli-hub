# CC Switch é‡æ„å®æ–½æ¸…å•

> ç”¨äºè·Ÿè¸ªé‡æ„è¿›åº¦çš„è¯¦ç»†æ£€æŸ¥æ¸…å•

**å¼€å§‹æ—¥æœŸ**: ___________
**é¢„è®¡å®Œæˆ**: ___________
**å½“å‰é˜¶æ®µ**: ___________

---

## ğŸ“‹ é˜¶æ®µ 0: å‡†å¤‡é˜¶æ®µ (é¢„è®¡ 1 å¤©)

### ç¯å¢ƒå‡†å¤‡

- [ ] åˆ›å»ºæ–°åˆ†æ”¯ `refactor/modernization`
- [ ] åˆ›å»ºå¤‡ä»½æ ‡ç­¾ `git tag backup-before-refactor`
- [ ] å¤‡ä»½ç”¨æˆ·é…ç½®æ–‡ä»¶ `~/.cli-hub/config.json`
- [ ] é€šçŸ¥å›¢é˜Ÿæˆå‘˜é‡æ„å¼€å§‹

### ä¾èµ–å®‰è£…

```bash
pnpm add @tanstack/react-query
pnpm add react-hook-form @hookform/resolvers
pnpm add zod
pnpm add sonner
pnpm add next-themes
pnpm add @radix-ui/react-dialog @radix-ui/react-dropdown-menu
pnpm add @radix-ui/react-label @radix-ui/react-select
pnpm add @radix-ui/react-slot @radix-ui/react-switch @radix-ui/react-tabs
pnpm add class-variance-authority clsx tailwind-merge tailwindcss-animate
```

- [ ] å®‰è£…æ ¸å¿ƒä¾èµ– (ä¸Šè¿°å‘½ä»¤)
- [ ] éªŒè¯ä¾èµ–å®‰è£…æˆåŠŸ `pnpm install`
- [ ] éªŒè¯ç¼–è¯‘é€šè¿‡ `pnpm typecheck`

### é…ç½®æ–‡ä»¶

- [ ] åˆ›å»º `components.json`
- [ ] æ›´æ–° `tsconfig.json` æ·»åŠ è·¯å¾„åˆ«å
- [ ] æ›´æ–° `vite.config.mts` æ·»åŠ è·¯å¾„è§£æ
- [ ] éªŒè¯å¼€å‘æœåŠ¡å™¨å¯åŠ¨ `pnpm dev`

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ (é¢„è®¡ 2-3 å¤©)

### 1.1 å·¥å…·å‡½æ•°å’ŒåŸºç¡€ç»„ä»¶

- [ ] åˆ›å»º `src/lib/utils.ts` (cn å‡½æ•°)
- [ ] åˆ›å»º `src/components/ui/button.tsx`
- [ ] åˆ›å»º `src/components/ui/dialog.tsx`
- [ ] åˆ›å»º `src/components/ui/input.tsx`
- [ ] åˆ›å»º `src/components/ui/label.tsx`
- [ ] åˆ›å»º `src/components/ui/textarea.tsx`
- [ ] åˆ›å»º `src/components/ui/select.tsx`
- [ ] åˆ›å»º `src/components/ui/switch.tsx`
- [ ] åˆ›å»º `src/components/ui/tabs.tsx`
- [ ] åˆ›å»º `src/components/ui/sonner.tsx`
- [ ] åˆ›å»º `src/components/ui/form.tsx`

**æµ‹è¯•**:
- [ ] éªŒè¯æ‰€æœ‰ UI ç»„ä»¶å¯ä»¥æ­£å¸¸å¯¼å…¥
- [ ] åˆ›å»ºä¸€ä¸ªæµ‹è¯•é¡µé¢éªŒè¯ç»„ä»¶æ ·å¼

### 1.2 Query Client è®¾ç½®

- [ ] åˆ›å»º `src/lib/query/queryClient.ts`
- [ ] é…ç½®é»˜è®¤é€‰é¡¹ (retry, staleTime ç­‰)
- [ ] å¯¼å‡º queryClient å®ä¾‹

### 1.3 API å±‚

- [ ] åˆ›å»º `src/lib/api/providers.ts`
  - [ ] getAll
  - [ ] getCurrent
  - [ ] add
  - [ ] update
  - [ ] delete
  - [ ] switch
  - [ ] importDefault
  - [ ] updateTrayMenu

- [ ] åˆ›å»º `src/lib/api/settings.ts`
  - [ ] get
  - [ ] save

- [ ] åˆ›å»º `src/lib/api/mcp.ts`
  - [ ] getConfig
  - [ ] upsertServer
  - [ ] deleteServer

- [ ] åˆ›å»º `src/lib/api/index.ts` (èšåˆå¯¼å‡º)

**æµ‹è¯•**:
- [ ] éªŒè¯ API è°ƒç”¨ä¸ä¼šå‡ºç°è¿è¡Œæ—¶é”™è¯¯
- [ ] ç¡®è®¤ç±»å‹å®šä¹‰æ­£ç¡®

### 1.4 Query Hooks

- [ ] åˆ›å»º `src/lib/query/queries.ts`
  - [ ] useProvidersQuery
  - [ ] useSettingsQuery
  - [ ] useMcpConfigQuery

- [ ] åˆ›å»º `src/lib/query/mutations.ts`
  - [ ] useAddProviderMutation
  - [ ] useSwitchProviderMutation
  - [ ] useDeleteProviderMutation
  - [ ] useUpdateProviderMutation
  - [ ] useSaveSettingsMutation

- [ ] åˆ›å»º `src/lib/query/index.ts` (èšåˆå¯¼å‡º)

**æµ‹è¯•**:
- [ ] åœ¨ä¸´æ—¶ç»„ä»¶ä¸­æµ‹è¯•æ¯ä¸ª hook
- [ ] éªŒè¯ loading/error çŠ¶æ€æ­£ç¡®
- [ ] éªŒè¯ç¼“å­˜å’Œè‡ªåŠ¨åˆ·æ–°å·¥ä½œ

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ é˜¶æ®µ 2: æ ¸å¿ƒåŠŸèƒ½é‡æ„ (é¢„è®¡ 3-4 å¤©)

### 2.1 ä¸»é¢˜ç³»ç»Ÿ

- [ ] åˆ›å»º `src/components/theme-provider.tsx`
- [ ] åˆ›å»º `src/components/mode-toggle.tsx`
- [ ] æ›´æ–° `src/index.css` æ·»åŠ ä¸»é¢˜å˜é‡
- [ ] åˆ é™¤ `src/hooks/useDarkMode.ts`
- [ ] æ›´æ–°æ‰€æœ‰ç»„ä»¶ä½¿ç”¨æ–°çš„ä¸»é¢˜ç³»ç»Ÿ

**æµ‹è¯•**:
- [ ] éªŒè¯ä¸»é¢˜åˆ‡æ¢æ­£å¸¸å·¥ä½œ
- [ ] éªŒè¯ç³»ç»Ÿä¸»é¢˜è·ŸéšåŠŸèƒ½
- [ ] éªŒè¯ä¸»é¢˜æŒä¹…åŒ–

### 2.2 æ›´æ–° main.tsx

- [ ] å¼•å…¥ QueryClientProvider
- [ ] å¼•å…¥ ThemeProvider
- [ ] æ·»åŠ  Toaster ç»„ä»¶
- [ ] ç§»é™¤æ—§çš„ API å¯¼å…¥

**æµ‹è¯•**:
- [ ] éªŒè¯åº”ç”¨å¯ä»¥æ­£å¸¸å¯åŠ¨
- [ ] éªŒè¯ Context æ­£ç¡®ä¼ é€’

### 2.3 é‡æ„ App.tsx

- [ ] ä½¿ç”¨ useProvidersQuery æ›¿ä»£æ‰‹åŠ¨çŠ¶æ€ç®¡ç†
- [ ] ç§»é™¤æ‰€æœ‰ loadProviders ç›¸å…³ä»£ç 
- [ ] ç§»é™¤æ‰‹åŠ¨ notification çŠ¶æ€
- [ ] ç®€åŒ–äº‹ä»¶ç›‘å¬é€»è¾‘
- [ ] æ›´æ–°å¯¹è¯æ¡†ä¸ºæ–°çš„ Dialog ç»„ä»¶

**ç›®æ ‡**: å°† 412 è¡Œä»£ç å‡å°‘åˆ° ~100 è¡Œ

**æµ‹è¯•**:
- [ ] éªŒè¯ä¾›åº”å•†åˆ—è¡¨æ­£å¸¸åŠ è½½
- [ ] éªŒè¯åˆ‡æ¢ Claude/Codex æ­£å¸¸å·¥ä½œ
- [ ] éªŒè¯äº‹ä»¶ç›‘å¬æ­£å¸¸å·¥ä½œ

### 2.4 é‡æ„ ProviderList

- [ ] åˆ›å»º `src/components/providers/ProviderList.tsx`
- [ ] ä½¿ç”¨ mutation hooks å¤„ç†æ“ä½œ
- [ ] ç§»é™¤ onNotify prop
- [ ] ç§»é™¤æ‰‹åŠ¨çŠ¶æ€ç®¡ç†

**æµ‹è¯•**:
- [ ] éªŒè¯ä¾›åº”å•†åˆ—è¡¨æ¸²æŸ“
- [ ] éªŒè¯åˆ‡æ¢æ“ä½œ
- [ ] éªŒè¯åˆ é™¤æ“ä½œ

### 2.5 é‡æ„è¡¨å•ç³»ç»Ÿ

- [ ] åˆ›å»º `src/lib/schemas/provider.ts` (Zod schema)
- [ ] åˆ›å»º `src/components/providers/ProviderForm.tsx`
  - [ ] ä½¿ç”¨ react-hook-form
  - [ ] ä½¿ç”¨ zodResolver
  - [ ] å­—æ®µçº§éªŒè¯

- [ ] åˆ›å»º `src/components/providers/AddProviderDialog.tsx`
  - [ ] ä½¿ç”¨æ–°çš„ Dialog ç»„ä»¶
  - [ ] é›†æˆ ProviderForm
  - [ ] ä½¿ç”¨ useAddProviderMutation

- [ ] åˆ›å»º `src/components/providers/EditProviderDialog.tsx`
  - [ ] ä½¿ç”¨æ–°çš„ Dialog ç»„ä»¶
  - [ ] é›†æˆ ProviderForm
  - [ ] ä½¿ç”¨ useUpdateProviderMutation

**æµ‹è¯•**:
- [ ] éªŒè¯è¡¨å•éªŒè¯æ­£å¸¸å·¥ä½œ
- [ ] éªŒè¯é”™è¯¯æç¤ºæ˜¾ç¤ºæ­£ç¡®
- [ ] éªŒè¯æäº¤æ“ä½œæˆåŠŸ
- [ ] éªŒè¯è¡¨å•é‡ç½®åŠŸèƒ½

### 2.6 æ¸…ç†æ—§ç»„ä»¶

- [x] åˆ é™¤ `src/components/AddProviderModal.tsx`
- [x] åˆ é™¤ `src/components/EditProviderModal.tsx`
- [x] æ›´æ–°æ‰€æœ‰å¼•ç”¨è¿™äº›ç»„ä»¶çš„åœ°æ–¹
- [x] åˆ é™¤ `src/components/ProviderForm.tsx` åŠ `src/components/ProviderForm/`

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ é˜¶æ®µ 3: è®¾ç½®å’Œè¾…åŠ©åŠŸèƒ½ (é¢„è®¡ 2-3 å¤©)

### 3.1 é‡æ„ SettingsDialog

- [ ] åˆ›å»º `src/components/settings/SettingsDialog.tsx`
  - [ ] ä½¿ç”¨ Tabs ç»„ä»¶
  - [ ] é›†æˆå„ä¸ªè®¾ç½®å­ç»„ä»¶

- [ ] åˆ›å»º `src/components/settings/GeneralSettings.tsx`
  - [ ] è¯­è¨€è®¾ç½®
  - [ ] é…ç½®ç›®å½•è®¾ç½®
  - [ ] å…¶ä»–é€šç”¨è®¾ç½®

- [ ] åˆ›å»º `src/components/settings/AboutSection.tsx`
  - [ ] ç‰ˆæœ¬ä¿¡æ¯
  - [ ] æ›´æ–°æ£€æŸ¥
  - [ ] é“¾æ¥

- [ ] åˆ›å»º `src/components/settings/ImportExportSection.tsx`
  - [ ] å¯¼å…¥åŠŸèƒ½
  - [ ] å¯¼å‡ºåŠŸèƒ½

**ç›®æ ‡**: å°† 643 è¡Œæ‹†åˆ†ä¸º 4-5 ä¸ªå°ç»„ä»¶ï¼Œæ¯ä¸ª 100-150 è¡Œ

**æµ‹è¯•**:
- [ ] éªŒè¯è®¾ç½®ä¿å­˜åŠŸèƒ½
- [ ] éªŒè¯å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- [ ] éªŒè¯æ›´æ–°æ£€æŸ¥åŠŸèƒ½

### 3.2 é‡æ„é€šçŸ¥ç³»ç»Ÿ

- [ ] åœ¨æ‰€æœ‰ mutations ä¸­ä½¿ç”¨ `toast` æ›¿ä»£ `showNotification`
- [ ] ç§»é™¤ App.tsx ä¸­çš„ notification çŠ¶æ€
- [ ] ç§»é™¤è‡ªå®šä¹‰é€šçŸ¥ç»„ä»¶

**æµ‹è¯•**:
- [ ] éªŒè¯æˆåŠŸé€šçŸ¥æ˜¾ç¤º
- [ ] éªŒè¯é”™è¯¯é€šçŸ¥æ˜¾ç¤º
- [ ] éªŒè¯é€šçŸ¥è‡ªåŠ¨æ¶ˆå¤±

### 3.3 é‡æ„ç¡®è®¤å¯¹è¯æ¡†

- [ ] æ›´æ–° `src/components/ConfirmDialog.tsx` ä½¿ç”¨æ–°çš„ Dialog
- [ ] æˆ–è€…ç›´æ¥ä½¿ç”¨ shadcn/ui çš„ AlertDialog

**æµ‹è¯•**:
- [ ] éªŒè¯åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
- [ ] éªŒè¯å…¶ä»–ç¡®è®¤åœºæ™¯

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ é˜¶æ®µ 4: æ¸…ç†å’Œä¼˜åŒ– (é¢„è®¡ 1-2 å¤©)

### 4.1 ç§»é™¤æ—§ä»£ç 

- [x] åˆ é™¤ `src/lib/styles.ts`
- [x] ä» `src/lib/tauri-api.ts` ç§»é™¤ `window.api` ç»‘å®š
- [x] ç²¾ç®€ `src/lib/tauri-api.ts`ï¼Œåªä¿ç•™äº‹ä»¶ç›‘å¬ç›¸å…³
- [x] åˆ é™¤æˆ–æ›´æ–° `src/vite-env.d.ts` ä¸­çš„è¿‡æ—¶ç±»å‹

### 4.2 ä»£ç å®¡æŸ¥

- [ ] æ£€æŸ¥æ‰€æœ‰ TODO æ³¨é‡Š
- [x] æ£€æŸ¥æ˜¯å¦è¿˜æœ‰ `window.api` è°ƒç”¨
- [ ] æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ‰‹åŠ¨çŠ¶æ€ç®¡ç†
- [x] ç»Ÿä¸€ä»£ç é£æ ¼

### 4.3 ç±»å‹æ£€æŸ¥

- [x] è¿è¡Œ `pnpm typecheck` ç¡®ä¿æ— é”™è¯¯
- [x] ä¿®å¤æ‰€æœ‰ç±»å‹é”™è¯¯
- [x] æ›´æ–°ç±»å‹å®šä¹‰

### 4.4 æ€§èƒ½ä¼˜åŒ–

- [ ] æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡æ¸²æŸ“
- [ ] æ·»åŠ å¿…è¦çš„ React.memo
- [ ] ä¼˜åŒ– Query ç¼“å­˜é…ç½®

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ é˜¶æ®µ 5: æµ‹è¯•å’Œä¿®å¤ (é¢„è®¡ 2-3 å¤©)

### 5.1 åŠŸèƒ½æµ‹è¯•

#### ä¾›åº”å•†ç®¡ç†
- [ ] æ·»åŠ ä¾›åº”å•† (Claude)
- [ ] æ·»åŠ ä¾›åº”å•† (Codex)
- [ ] ç¼–è¾‘ä¾›åº”å•†
- [ ] åˆ é™¤ä¾›åº”å•†
- [ ] åˆ‡æ¢ä¾›åº”å•†
- [ ] å¯¼å…¥é»˜è®¤é…ç½®

#### åº”ç”¨åˆ‡æ¢
- [ ] Claude <-> Codex åˆ‡æ¢
- [ ] åˆ‡æ¢åæ•°æ®æ­£ç¡®åŠ è½½
- [ ] åˆ‡æ¢åæ‰˜ç›˜èœå•æ›´æ–°

#### è®¾ç½®
- [ ] ä¿å­˜é€šç”¨è®¾ç½®
- [ ] åˆ‡æ¢è¯­è¨€
- [ ] é…ç½®ç›®å½•é€‰æ‹©
- [ ] å¯¼å…¥é…ç½®
- [ ] å¯¼å‡ºé…ç½®

#### UI äº¤äº’
- [ ] ä¸»é¢˜åˆ‡æ¢ (äº®è‰²/æš—è‰²)
- [ ] å¯¹è¯æ¡†æ‰“å¼€/å…³é—­
- [ ] è¡¨å•éªŒè¯
- [ ] Toast é€šçŸ¥

#### MCP ç®¡ç†
- [ ] åˆ—è¡¨æ˜¾ç¤º
- [ ] æ·»åŠ  MCP
- [ ] ç¼–è¾‘ MCP
- [ ] åˆ é™¤ MCP
- [ ] å¯ç”¨/ç¦ç”¨ MCP

### 5.2 è¾¹ç•Œæƒ…å†µæµ‹è¯•

- [ ] ç©ºä¾›åº”å•†åˆ—è¡¨
- [ ] æ— æ•ˆé…ç½®æ–‡ä»¶
- [ ] ç½‘ç»œé”™è¯¯
- [ ] åç«¯é”™è¯¯å“åº”
- [ ] å¹¶å‘æ“ä½œ
- [ ] è¡¨å•è¾“å…¥è¾¹ç•Œå€¼

### 5.3 å…¼å®¹æ€§æµ‹è¯•

- [ ] Windows æµ‹è¯•
- [ ] macOS æµ‹è¯•
- [ ] Linux æµ‹è¯•

### 5.4 æ€§èƒ½æµ‹è¯•

- [ ] 100+ ä¾›åº”å•†åŠ è½½é€Ÿåº¦
- [ ] å¿«é€Ÿåˆ‡æ¢ä¾›åº”å•†
- [ ] å†…å­˜ä½¿ç”¨æƒ…å†µ
- [ ] CPU ä½¿ç”¨æƒ…å†µ

### 5.5 Bug ä¿®å¤

**Bug åˆ—è¡¨** (å‘ç°åè®°å½•):

1. ___________
   - [ ] å·²ä¿®å¤
   - [ ] å·²éªŒè¯

2. ___________
   - [ ] å·²ä¿®å¤
   - [ ] å·²éªŒè¯

**å®Œæˆæ—¶é—´**: ___________
**é‡åˆ°çš„é—®é¢˜**: ___________

---

## ğŸ“‹ æœ€ç»ˆæ£€æŸ¥

### ä»£ç è´¨é‡

- [ ] æ‰€æœ‰ TypeScript é”™è¯¯å·²ä¿®å¤
- [ ] è¿è¡Œ `pnpm format` æ ¼å¼åŒ–ä»£ç 
- [ ] è¿è¡Œ `pnpm typecheck` é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ

### æ–‡æ¡£æ›´æ–°

- [ ] æ›´æ–° `CLAUDE.md` åæ˜ æ–°æ¶æ„
- [ ] æ›´æ–° `README.md` (å¦‚æœ‰å¿…è¦)
- [ ] æ·»åŠ  Migration Guide (å¯é€‰)

### æ€§èƒ½åŸºå‡†

è®°å½•æ€§èƒ½æ•°æ®:

**æ—§ç‰ˆæœ¬**:
- å¯åŠ¨æ—¶é—´: _____ms
- ä¾›åº”å•†åŠ è½½: _____ms
- å†…å­˜å ç”¨: _____MB

**æ–°ç‰ˆæœ¬**:
- å¯åŠ¨æ—¶é—´: _____ms
- ä¾›åº”å•†åŠ è½½: _____ms
- å†…å­˜å ç”¨: _____MB

### ä»£ç ç»Ÿè®¡

**ä»£ç è¡Œæ•°å¯¹æ¯”**:

| æ–‡ä»¶ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | å‡å°‘ |
|------|--------|--------|------|
| App.tsx | 412 | ~100 | -76% |
| tauri-api.ts | 712 | ~50 | -93% |
| ProviderForm.tsx | 271 | ~150 | -45% |
| settings æ¨¡å— | 1046 | ~470 (æ‹†åˆ†) | -55% |
| **æ€»è®¡** | 2038 | ~700 | **-66%** |

---

## ğŸ“¦ å‘å¸ƒå‡†å¤‡

### Pre-release æµ‹è¯•

- [ ] åˆ›å»º beta ç‰ˆæœ¬ `v4.0.0-beta.1`
- [ ] åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ

### æ­£å¼å‘å¸ƒ

- [ ] åˆå¹¶åˆ° main åˆ†æ”¯
- [ ] åˆ›å»º Release Tag `v4.0.0`
- [ ] æ›´æ–° Changelog
- [ ] å‘å¸ƒ GitHub Release
- [ ] é€šçŸ¥ç”¨æˆ·æ›´æ–°

---

## ğŸš¨ å›æ»šè§¦å‘æ¡ä»¶

å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œè€ƒè™‘å›æ»š:

- [ ] é‡å¤§åŠŸèƒ½æ— æ³•ä½¿ç”¨
- [ ] ç”¨æˆ·æ•°æ®ä¸¢å¤±
- [ ] ä¸¥é‡æ€§èƒ½é—®é¢˜
- [ ] æ— æ³•ä¿®å¤çš„å…¼å®¹æ€§é—®é¢˜

**å›æ»šå‘½ä»¤**:
```bash
git reset --hard backup-before-refactor
# æˆ–
git revert <commit-range>
```

---

## ğŸ“ æ€»ç»“æŠ¥å‘Š

### æˆåŠŸæŒ‡æ ‡

- [ ] æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] ä»£ç é‡å‡å°‘ 40%+
- [ ] æ— ç”¨æˆ·æ•°æ®ä¸¢å¤±
- [ ] æ€§èƒ½æœªä¸‹é™

### ç»éªŒæ•™è®­

**é‡åˆ°çš„ä¸»è¦æŒ‘æˆ˜**:
1. ___________
2. ___________
3. ___________

**è§£å†³æ–¹æ¡ˆ**:
1. ___________
2. ___________
3. ___________

**æœªæ¥æ”¹è¿›**:
1. ___________
2. ___________
3. ___________

---

**é‡æ„å®Œæˆæ—¥æœŸ**: ___________
**æ€»è€—æ—¶**: _____ å¤©
**å‚ä¸äººå‘˜**: ___________
