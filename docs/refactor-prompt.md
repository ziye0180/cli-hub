# 大文件组件化拆分通用提示词

适用场景：将数百/上千行的单文件（如 `src/App.tsx`）按职责垂直拆分成可维护的组件/模块，适配任意技术栈（React/Vue/Svelte、后端框架、原生等）。

## 使用前准备
- 指定目标文件绝对路径与主要技术栈（如 React + TypeScript + Tailwind）。
- 说明运行/构建限制（不可跑 dev、可跑 lint/test 的命令名）。
- 描述当前已存在的拆分成果（避免重复创建）。
- 明确验收标准：功能不回归、lint/test 通过、结构清晰。

## 通用提示词模板
将下列文本整体粘贴给重构代理，并填充括号中的内容。

```text
你现在是代码重构助手，目标是把一个超大单文件按职责垂直拆分成若干组件/模块，保持行为不变、依赖不破坏。

【项目背景】技术栈：<技术栈>；目标文件：<绝对路径>；已有已拆分组件（如有）：<列出或写“无”>。
【约束】不得运行被禁止的命令：<列出>；可用的质量命令：<如 pnpm typecheck / pnpm test:unit>；保持同等外观与功能；避免推测性功能。
【拆分目标】
1) 拆分出清晰的页面/容器/业务组件层次；
2) 共享逻辑抽到 hooks/服务/工具；
3) 样式与结构解耦（如可抽出样式文件或复用现有样式体系）；
4) 保持数据流与副作用一致，删除未用代码；
5) 输出更新后的文件树与变更点说明。

【必须产出】
- 新的目录结构与文件名列表。
- 关键组件/模块的接口（props / 参数 / 导出函数）说明。
- 关键逻辑拆分思路（状态、数据获取、副作用）。
- 需要同步更新的引用点（import 路径）。
- 推荐的最小验证步骤（lint/test/构建）。

【拆分指引】
- 先识别页面骨架与主要路由/入口，再下钻到板块组件。
- 以“单一职责 + 可复用”切块：UI 展示、交互逻辑、数据获取、状态管理、样式。
- 如果已有同类组件/工具，复用而非新建。
- 副作用集中管理：数据请求、订阅、定时器、全局事件需在拆分后仍成对注册/清理。
- 保持类型安全：显式 props 类型/接口，删除 any；保留/提升现有类型定义。
- 处理样式：复用现有变量/设计系统；必要时创建局部样式文件并避免全局泄漏。
- 添加/更新测试：现有测试需适配新路径；必要时补充关键路径的单元/集成测试。

【输出格式】
1) 变更摘要（要点列表）。
2) 拆分后的目录树（相对路径）。
3) 组件/模块接口表（名称、职责、主要 props/导出）。
4) 验证步骤（命令列表）。
5) 潜在风险与回滚提示。

请按以上要求给出拆分方案，必要时提出澄清问题后再执行。
```

## 拆分策略要点（可附在提示词末尾）
- 垂直切分优先：按页面区块/业务流，而非随意按功能散切。
- 状态归属明确：局部状态留在组件，跨区块状态提升或放全局 store。
- 副作用对称：订阅/定时器/事件在 `useEffect`/生命周期中成对注册/清理。
- 数据流透明：props/事件向下，回调向上；避免隐式全局单例。
- 类型与接口先行：先写接口，再迁移实现，减少回归。
- 路径一致性：拆分后立即修正 import 路径与 barrel（index.ts）。
- 测试护栏：先跑现有测试，拆分后补充关键集成/渲染用例。

## 验收清单
- 目录树与文件命名符合约定，未生成重复/无用文件。
- 构建/类型检查/单测在允许范围内全部通过。
- 视觉与交互行为对齐：无事件丢失、无样式回归。
- 未使用代码已移除或标记弃用，未留下 TODO 无主项。
- 文档/注释同步更新（若有新公共接口）。

## 常见坑位提醒
- 默认导出改为命名导出后需全局替换。
- 相对路径层级变更导致资源/样式引用失效。
- 全局单例（store、事件总线）重复初始化。
- 国际化 key、feature flag、权限判定逻辑遗漏。
- 样式作用域污染（全局类名/重置样式）。

使用方法：将模板粘贴到你的重构代理，对括号内容做最小替换即可在任何技术栈下复用。
